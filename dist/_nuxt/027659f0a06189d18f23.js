(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{426:function(t,e,r){var content=r(469);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(5).default)("389e2e4e",content,!0,{sourceMap:!1})},468:function(t,e,r){"use strict";var n=r(426);r.n(n).a},469:function(t,e,r){(t.exports=r(4)(!1)).push([t.i,".post-edit__container[data-v-3147bf4c]{max-width:1240px;text-align:center;color:#999}.post-edit[data-v-3147bf4c]{width:100%}#ref-image[data-v-3147bf4c]{display:none}.label-ef-image[data-v-3147bf4c]{background-color:#fff;display:inline-block;text-align:center;border-radius:2rem;margin:0 auto 2rem;padding:.5rem 1rem;cursor:pointer}.title__container[data-v-3147bf4c]{display:flex;flex-direction:column;background-color:#707070;background-size:cover;padding-top:5rem;margin-bottom:2rem}.title[data-v-3147bf4c]{width:80%;color:#fff;background-color:#999;font-size:18px;border:2px dotted #fff;border-radius:7px;margin:0 auto 2rem;padding:.5rem}.necessary[data-v-3147bf4c]{font-size:.8rem;color:#f34a80;border:1px solid #f34a80;border-radius:3px;padding:.2rem}.new_text[data-v-3147bf4c]{width:80%;background-color:#eee;border:none;border-radius:4px;margin-bottom:2rem}.new_button__container[data-v-3147bf4c]{display:flex;justify-content:center;border-top:1px solid #999;padding-top:2rem}.app_button[data-v-3147bf4c] .app_button{width:13rem}.post__audio[data-v-3147bf4c]{margin-bottom:1rem;text-align:center}.post__audio .audio[data-v-3147bf4c]{width:80%}.text-editor__container[data-v-3147bf4c]{max-width:62rem;margin:auto}.text-editor[data-v-3147bf4c]{font-size:1.4rem;color:#333;text-align:left;border:.1rem solid #ccc;border-radius:.3rem;padding:2.4rem;margin:0 1rem 1rem}.text-editor[data-v-3147bf4c] .codex-editor__redactor{min-height:15rem;padding-bottom:0!important}.text-editor[data-v-3147bf4c] .icon--bold{height:14px}",""])},505:function(t,e,r){"use strict";r.r(e);var n=r(8),o=(r(25),r(6)),c=r(123),d=r(453),l=r.n(d),f=r(19),m=r(16),h=m.b.collection("posts"),v=m.d.ref("thumbnails"),_={components:{AppButton:c.a},asyncData:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.query,t.next=3,h.doc(r.id).get().then(function(t){var data=t.data(),e=JSON.parse(data.article);return data.article=e,{post:data}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),data:function(){return{editor:null,rawImageFile:null}},computed:Object(n.a)({},Object(f.c)({postId:function(t){return t.post.postData.id},audioUrl:function(t){return t.post.postData.audioUrl}}),{getThumbnailImage:function(){return"background-image: url(".concat(this.post.thumbnail_photo_url,")")}}),created:function(){this.editor=new l.a({holder:"editor",data:{blocks:this.post.article}})},methods:{inputImage:function(){var t=this.$refs.file.files[0],e=window.URL.createObjectURL(t);this.rawImageFile=t,this.post.thumbnail_photo_url=e},uploadThumbnailImage:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(data){var e,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=v.child(this.post.id),t.next=3,e.put(data).then(function(t){console.log("upload success!!: ".concat(t.state))});case 3:return t.next=5,e.getDownloadURL().then(function(t){r.post.thumbnail_photo_url=t});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getArticleData:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.editor.save().then(function(data){e.post.article=JSON.stringify(data.blocks)});case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),updatePost:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.rawImageFile){t.next=3;break}return t.next=3,this.uploadThumbnailImage(this.rawImageFile);case 3:return t.next=5,this.getArticleData();case 5:m.b.collection("posts").doc(this.post.id).update(this.post).then(function(){console.log("update success!! post ID: ".concat(e.post.id)),e.$router.push("/my-posts")}).catch(function(t){console.error(t)});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleClick:function(){this.$router.push("/my-posts")}}},x=(r(468),r(0)),component=Object(x.a)(_,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"post-edit__container"},[r("div",{staticClass:"post-edit"},[r("main",{staticClass:"title__container",style:t.getThumbnailImage},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.post.title,expression:"post.title"}],staticClass:"title",attrs:{placeholder:"タイトルを編集"},domProps:{value:t.post.title},on:{input:function(e){e.target.composing||t.$set(t.post,"title",e.target.value)}}}),t._v(" "),r("input",{ref:"file",attrs:{id:"ref-image",type:"file",multiple:"",accept:"image/jpeg, image/png"},on:{change:t.inputImage}}),t._v(" "),r("label",{staticClass:"label-ef-image",attrs:{for:"ref-image"}},[t._v("\n        + サムネイルを画像設定する\n      ")])]),t._v(" "),r("div",[r("figure",{staticClass:"post__audio"},[r("audio",{staticClass:"audio",attrs:{controls:"",preload:"auto",src:t.post.audio_url}},[r("code",[t._v("audio")]),t._v(" element\n        ")])])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),r("div",{staticClass:"new_button__container"},[r("app-button",{staticClass:"app_button cancel_button",attrs:{text:"RETURN",color:"gray"},on:{click:t.handleClick}}),t._v(" "),r("app-button",{staticClass:"app_button post_button",attrs:{text:"UPDATE",color:"pink"},on:{click:t.updatePost}})],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n      きょうのおはなし (最大 126 文字) "),e("span",{staticClass:"necessary"},[this._v("必須")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-editor__container"},[e("div",{staticClass:"text-editor",attrs:{id:"editor"}})])}],!1,null,"3147bf4c",null);e.default=component.exports}}]);