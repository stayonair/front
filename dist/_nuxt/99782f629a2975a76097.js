(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{396:function(t,e,n){var content=n(413);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(5).default)("19275cfa",content,!0,{sourceMap:!1})},412:function(t,e,n){"use strict";var r=n(396);n.n(r).a},413:function(t,e,n){(t.exports=n(4)(!1)).push([t.i,".icon--loading[data-v-703e6494]{width:6rem;fill:#269edd;z-index:2}",""])},416:function(t,e,n){"use strict";n(412);var r=n(0),component=Object(r.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticClass:"icon--loading",staticStyle:{"enable-background":"new 0 0 16 16"},attrs:{id:"Layer_1",height:"16px",version:"1.1",viewBox:"0 0 16 16",width:"16px","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[e("path",{attrs:{d:"M8,0C7.448,0,7,0.448,7,1v2c0,0.552,0.448,1,1,1s1-0.448,1-1V1C9,0.448,8.552,0,8,0z M8,12c-0.552,0-1,0.447-1,1v2  c0,0.553,0.448,1,1,1s1-0.447,1-1v-2C9,12.447,8.552,12,8,12z M12.242,5.172l1.414-1.415c0.391-0.39,0.391-1.024,0-1.414  c-0.39-0.391-1.023-0.391-1.414,0l-1.414,1.414c-0.391,0.391-0.391,1.024,0,1.415C11.219,5.562,11.852,5.562,12.242,5.172z   M3.757,10.828l-1.414,1.414c-0.391,0.391-0.391,1.024,0,1.414c0.39,0.391,1.023,0.391,1.414,0l1.414-1.414  c0.391-0.391,0.391-1.023,0-1.414C4.781,10.438,4.148,10.438,3.757,10.828z M3.757,2.343c-0.391-0.391-1.024-0.391-1.414,0  c-0.391,0.39-0.391,1.024,0,1.414l1.414,1.415c0.391,0.39,1.024,0.39,1.414,0c0.391-0.391,0.391-1.024,0-1.415L3.757,2.343z   M12.242,10.828c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414l1.414,1.414c0.391,0.391,1.024,0.391,1.414,0  c0.391-0.39,0.391-1.023,0-1.414L12.242,10.828z M15,7h-2c-0.553,0-1,0.448-1,1s0.447,1,1,1h2c0.553,0,1-0.448,1-1S15.553,7,15,7z   M4,8c0-0.552-0.448-1-1-1H1C0.448,7,0,7.448,0,8s0.448,1,1,1h2C3.552,9,4,8.552,4,8z"}})])},[],!1,null,"703e6494",null);e.a=component.exports},441:function(t,e,n){var content=n(492);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(5).default)("3efcd053",content,!0,{sourceMap:!1})},491:function(t,e,n){"use strict";var r=n(441);n.n(r).a},492:function(t,e,n){(t.exports=n(4)(!1)).push([t.i,".new__container[data-v-0d1c2425]{max-width:1240px;text-align:center;color:#999}.new[data-v-0d1c2425]{width:100%}#ref-image[data-v-0d1c2425]{display:none}.label-ef-image[data-v-0d1c2425]{background-color:#fff;display:inline-block;text-align:center;border-radius:2rem;margin:0 auto 2rem;padding:.5rem 1rem;cursor:pointer}.title__container[data-v-0d1c2425]{display:flex;flex-direction:column;background-color:#707070;background-size:cover;padding-top:5rem;margin-bottom:2rem}.title[data-v-0d1c2425]{width:80%;color:#fff;background-color:#999;font-size:18px;border:2px dotted #fff;border-radius:7px;margin:0 auto 2rem;padding:.5rem}.necessary[data-v-0d1c2425]{font-size:.8rem;color:#f34a80;border:1px solid #f34a80;border-radius:3px;padding:.2rem}.new_text[data-v-0d1c2425]{width:80%;background-color:#eee;border:none;border-radius:4px;margin-bottom:2rem}.new_button__container[data-v-0d1c2425]{display:flex;justify-content:center;border-top:1px solid #999;padding-top:2rem}.app_button[data-v-0d1c2425] .app_button{width:13rem}.post__audio[data-v-0d1c2425]{margin-bottom:1rem;text-align:center}.post__audio .audio[data-v-0d1c2425]{width:80%}.text-editor__container[data-v-0d1c2425]{max-width:62rem;margin:auto}.text-editor[data-v-0d1c2425]{font-size:1.4rem;color:#333;text-align:left;border:.1rem solid #ccc;border-radius:.3rem;padding:2.4rem;margin:0 1rem 1rem}.text-editor[data-v-0d1c2425] .codex-editor__redactor{min-height:15rem;padding-bottom:0!important}.text-editor[data-v-0d1c2425] .icon--bold{height:14px}.loading_icon[data-v-0d1c2425]{position:absolute;-webkit-animation:loading_icon-data-v-0d1c2425 5s linear infinite;animation:loading_icon-data-v-0d1c2425 5s linear infinite;left:59rem}@media only screen and (max-width:834px){.loading_icon[data-v-0d1c2425]{left:35.5rem}}@media only screen and (max-width:480px){.loading_icon[data-v-0d1c2425]{left:16rem}}@-webkit-keyframes loading_icon-data-v-0d1c2425{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes loading_icon-data-v-0d1c2425{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""])},512:function(t,e,n){"use strict";n.r(e);n(25);var r=n(6),o=n(8),c=n(123),d=n(416),l=n(453),m=n.n(l),f=n(19),h=n(16),v=h.d.ref("thumbnails"),_={components:{AppButton:c.a,IconLoading:d.a},middleware:function(t){var e=t.store,n=t.redirect;if(!e.state.post.postData.audioUrl)return n("/recording")},data:function(){return{isLoading:!1,isDisabled:!1,editor:null,postData:{title:"",thumbnail_photo_url:"",article:""},thumbnailImageUrl:null,rawImageFile:null}},computed:Object(o.a)({},Object(f.c)({postId:function(t){return t.post.postData.id},audioUrl:function(t){return t.post.postData.audioUrl},user:function(t){return t.auth.user}}),{getThumbnailImage:function(){return"background-image: url(".concat(this.thumbnailImageUrl,")")}}),created:function(){this.editor=new m.a({holder:"editor"})},methods:{inputImage:function(){var t=this.$refs.file.files[0],e=window.URL.createObjectURL(t);this.rawImageFile=t,this.thumbnailImageUrl=e},uploadThumbnailImage:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(data){var e,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=v.child(this.postId),t.next=3,e.put(data).then(function(t){console.log("upload success!!: ".concat(t.state))});case 3:return t.next=5,e.getDownloadURL().then(function(t){n.postData.thumbnail_photo_url=t});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getArticleData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.editor.save().then(function(data){e.postData.article=JSON.stringify(data.blocks)});case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),uploadPost:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isLoading=!0,!this.isDisabled){t.next=3;break}return t.abrupt("return");case 3:return this.isDisabled=!0,t.next=6,this.uploadThumbnailImage(this.rawImageFile);case 6:return t.next=8,this.getArticleData();case 8:e={id:this.postId,author:{uid:this.user.uid,name:this.user.displayName,icon_url:this.user.photoURL},title:this.postData.title,thumbnail_photo_url:this.postData.thumbnail_photo_url,audio_url:this.audioUrl,article:this.postData.article,likes:[],posted_at:h.c.firestore.FieldValue.serverTimestamp()},h.b.collection("posts").doc(this.postId).set(e).then(function(){n.isLoading=!1,n.isDisabled=!1,console.log("success!! post ID: ".concat(n.postId)),n.$router.push("/my-posts")}).catch(function(t){console.error(t)});case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleClick:function(){this.isLoading=!0,this.isDisabled=!0,console.log("clicked!!"),this.isLoading=!1,this.isDisabled=!1}}},x=(n(491),n(0)),component=Object(x.a)(_,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"new__container"},[t.isLoading?n("icon-loading",{staticClass:"loading_icon"}):t._e(),t._v(" "),n("div",{staticClass:"new"},[n("main",{staticClass:"title__container",style:t.getThumbnailImage},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.postData.title,expression:"postData.title"}],staticClass:"title",attrs:{placeholder:"タイトルを入力"},domProps:{value:t.postData.title},on:{input:function(e){e.target.composing||t.$set(t.postData,"title",e.target.value)}}}),t._v(" "),n("input",{ref:"file",attrs:{id:"ref-image",type:"file",multiple:"",accept:"image/jpeg, image/png"},on:{change:function(e){return t.inputImage()}}}),t._v(" "),n("label",{staticClass:"label-ef-image",attrs:{for:"ref-image"}},[t._v("\n        + サムネイルを画像設定する\n      ")])]),t._v(" "),n("div",[n("figure",{staticClass:"post__audio"},[n("audio",{staticClass:"audio",attrs:{controls:"",preload:"auto",src:t.audioUrl}},[n("code",[t._v("audio")]),t._v(" element\n        ")])])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),n("div",{staticClass:"new_button__container"},[n("app-button",{staticClass:"app_button cancel_button",attrs:{text:"CANCEL",color:"gray"},on:{click:function(e){return t.handleClick()}}}),t._v(" "),n("app-button",{staticClass:"app_button post_button",attrs:{text:"POST",color:"pink"},on:{click:function(e){return t.uploadPost()}}})],1)])],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n      きょうのおはなし (最大 126 文字) "),e("span",{staticClass:"necessary"},[this._v("必須")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-editor__container"},[e("div",{staticClass:"text-editor",attrs:{id:"editor"}})])}],!1,null,"0d1c2425",null);e.default=component.exports}}]);