(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{291:function(t,e,o){var content=o(296);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(5).default)("2863fd0a",content,!0,{sourceMap:!1})},295:function(t,e,o){"use strict";var r=o(291);o.n(r).a},296:function(t,e,o){(t.exports=o(4)(!1)).push([t.i,".app_button[data-v-761c1ffe]{position:relative;padding:1rem;border-radius:2rem;font:inherit;line-height:normal;overflow:visible;transition:all .2s;-webkit-appearance:none;-moz-appearance:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.app_button[data-v-761c1ffe]:focus,.app_button[data-v-761c1ffe]:hover{cursor:pointer;opacity:.6}.app_button[data-v-761c1ffe]:disabled{background-color:#d1d1d1;border:1px solid #d1d1d1}.is_white[data-v-761c1ffe]{border:1px solid #fafcff;background-color:#fafcff;color:#2f7db3}.is_gray[data-v-761c1ffe]{border:1px solid #707070;background-color:#707070;color:#fafcff}.is_pink[data-v-761c1ffe]{border:1px solid #ff7989;background-color:#ff7989;color:#fafcff}.is_transparent[data-v-761c1ffe]{border:2px solid #fafcff;background-color:transparent;color:#fafcff}.icon[data-v-761c1ffe]{position:absolute;top:1.2rem;left:1.6rem}",""])},297:function(t,e,o){"use strict";o(42),o(83);var r={name:"AppButton",props:{text:{type:String,default:""},icon:{type:String,default:""},color:{type:String,default:"white",validator:function(t){return["white","gray","pink","transparent"].includes(t)}},disabled:{type:Boolean,default:!1},type:{type:String,default:"submit",validator:function(t){return["submit","button"].includes(t)}}},computed:{buttonClasses:function(){var t={app_button:!0};return t["is_".concat(this.color)]=!0,t},awesomeIcon:function(){return this.icon}},methods:{handleClick:function(t){this.$emit("click",t)}}},n=(o(295),o(0)),component=Object(n.a)(r,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app_button__wrapper"},[o("div",{staticClass:"app_button__container"},[o("button",{class:t.buttonClasses,attrs:{type:t.type,disabled:t.disabled},on:{click:t.handleClick}},[t.icon?o("i",{staticClass:"icon",class:t.awesomeIcon}):t._e(),t._v("\n      "+t._s(t.text)+"\n    ")])])])},[],!1,null,"761c1ffe",null);e.a=component.exports},328:function(t,e,o){var content=o(367);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(5).default)("284cd57b",content,!0,{sourceMap:!1})},366:function(t,e,o){"use strict";var r=o(328);o.n(r).a},367:function(t,e,o){(t.exports=o(4)(!1)).push([t.i,".new__container[data-v-7854f4b7]{max-width:1240px;text-align:center;color:#999}.new[data-v-7854f4b7]{width:100%}#ref-image[data-v-7854f4b7]{display:none}.label-ef-image[data-v-7854f4b7]{background-color:#fff;display:inline-block;text-align:center;border-radius:2rem;margin:0 auto 2rem;padding:.5rem 1rem;cursor:pointer}.title__container[data-v-7854f4b7]{display:flex;flex-direction:column;background-color:#707070;background-size:cover;padding-top:5rem;margin-bottom:2rem}.title[data-v-7854f4b7]{width:80%;color:#fff;background-color:#999;font-size:18px;border:2px dotted #fff;border-radius:7px;margin:0 auto 2rem;padding:.5rem}.necessary[data-v-7854f4b7]{font-size:.8rem;color:#f34a80;border:1px solid #f34a80;border-radius:3px;padding:.2rem}.new_text[data-v-7854f4b7]{width:80%;background-color:#eee;border:none;border-radius:4px;margin-bottom:2rem}.new_button__container[data-v-7854f4b7]{display:flex;justify-content:center;border-top:1px solid #999;padding-top:2rem}.app_button[data-v-7854f4b7] .app_button{width:13rem}.post__audio[data-v-7854f4b7]{margin-bottom:1rem;text-align:center}.post__audio .audio[data-v-7854f4b7]{width:80%}.text-editor__container[data-v-7854f4b7]{max-width:62rem;margin:auto}.text-editor[data-v-7854f4b7]{font-size:1.4rem;color:#333;text-align:left;border:.1rem solid #ccc;border-radius:.3rem;padding:2.4rem;margin:0 1rem 1rem}.text-editor[data-v-7854f4b7] .codex-editor__redactor{min-height:15rem;padding-bottom:0!important}.text-editor[data-v-7854f4b7] .icon--bold{height:14px}",""])},384:function(t,e,o){"use strict";o.r(e);o(28);var r=o(7),n=o(9),c=o(297),l=o(365),d=o.n(l),f=o(25),m=o(17),h=m.a.firestore(),_=m.a.storage().ref("thumbnails"),v={components:{AppButton:c.a},middleware:function(t){var e=t.store,o=t.redirect;if(!e.state.post.postData.audioUrl)return o("/recording")},data:function(){return{editor:null,postData:{title:"",thumbnail_photo_url:"",article:""},thumbnailImageUrl:null,rawImageFile:null}},computed:Object(n.a)({},Object(f.c)({postId:function(t){return t.post.postData.id},audioUrl:function(t){return t.post.postData.audioUrl},auth:function(t){return t.auth.user}}),{getThumbnailImage:function(){return"background-image: url(".concat(this.thumbnailImageUrl,")")}}),created:function(){this.editor=new d.a({holder:"editor"})},methods:{inputImage:function(){var t=this.$refs.file.files[0],e=window.URL.createObjectURL(t);this.rawImageFile=t,this.thumbnailImageUrl=e},uploadThumbnailImage:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(data){var e,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=_.child(this.postId),t.next=3,e.put(data).then(function(t){console.log("upload success!!: ".concat(t.state))});case 3:return t.next=5,e.getDownloadURL().then(function(t){o.postData.thumbnail_photo_url=t});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getArticleData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.editor.save().then(function(data){e.postData.article=JSON.stringify(data)});case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),uploadPost:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.rawImageFile){t.next=3;break}return console.log("Nothing Image File"),t.abrupt("return");case 3:return t.next=5,this.uploadThumbnailImage(this.rawImageFile);case 5:return t.next=7,this.getArticleData();case 7:e={id:this.postId,author:{uid:this.auth.uid,name:this.auth.displayName,icon_url:this.auth.photoURL},title:this.postData.title,thumbnail_photo_url:this.postData.thumbnail_photo_url,audio_url:this.audioUrl,article:this.postData.article,posted_at:m.a.firestore.FieldValue.serverTimestamp()},h.collection("posts").doc(this.postId).set(e).then(function(){console.log("success!! post ID: ".concat(o.postId)),o.$router.push("/posts")}).catch(function(t){console.error(t)});case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleClick:function(){console.log("clicked!!")}}},x=(o(366),o(0)),component=Object(x.a)(v,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"new__container"},[o("div",{staticClass:"new"},[o("main",{staticClass:"title__container",style:t.getThumbnailImage},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.postData.title,expression:"postData.title"}],staticClass:"title",attrs:{placeholder:"タイトルを入力"},domProps:{value:t.postData.title},on:{input:function(e){e.target.composing||t.$set(t.postData,"title",e.target.value)}}}),t._v(" "),o("input",{ref:"file",attrs:{id:"ref-image",type:"file",multiple:"",accept:"image/jpeg, image/png"},on:{change:t.inputImage}}),t._v(" "),o("label",{staticClass:"label-ef-image",attrs:{for:"ref-image"}},[t._v("\n        + サムネイルを画像設定する\n      ")])]),t._v(" "),o("div",[o("figure",{staticClass:"post__audio"},[o("audio",{staticClass:"audio",attrs:{controls:"",preload:"auto",src:t.audioUrl}},[o("code",[t._v("audio")]),t._v(" element\n        ")])])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),o("div",{staticClass:"new_button__container"},[o("app-button",{staticClass:"app_button cancel_button",attrs:{text:"CANCEL",color:"gray"},on:{click:t.handleClick}}),t._v(" "),o("app-button",{staticClass:"app_button post_button",attrs:{text:"POST",color:"pink"},on:{click:t.uploadPost}})],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n      きょうのおはなし (最大 126 文字) "),e("span",{staticClass:"necessary"},[this._v("必須")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-editor__container"},[e("div",{staticClass:"text-editor",attrs:{id:"editor"}})])}],!1,null,"7854f4b7",null);e.default=component.exports}}]);